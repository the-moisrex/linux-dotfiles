version: "3.9"

services:
  compiler-explorer:
    image: madduci/docker-compiler-explorer
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.compiler.entrypoints=web"
      - "traefik.http.routers.compiler.rule=Host(`compiler.localhost`) || Host(`compiler`) || Host(`compiler.local`)"
      # - "traefik.http.routers.compiler.tls.certresolver=selfsigned"
      # - "traefik.http.routers.compiler.middlewares=redirect-to-https"
      - "traefik.http.services.compiler.loadbalancer.server.port=10240"
    restart: unless-stopped

  excalidraw:
    image: excalidraw/excalidraw
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.excalidraw.entrypoints=web"
      - "traefik.http.routers.excalidraw.rule=Host(`draw.localhost`) || Host(`draw.local`) || Host(`draw`)"
      # - "traefik.http.routers.excalidraw.tls.certresolver=selfsigned"
      # - "traefik.http.routers.excalidraw.middlewares=redirect-to-https"
      - "traefik.http.services.excalidraw.loadbalancer.server.port=80"
    restart: unless-stopped

  devdocs:
    image: ghcr.io/freecodecamp/devdocs
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.devdocs.entrypoints=web"
      - "traefik.http.routers.devdocs.rule=Host(`docs.localhost`) || Host(`docs.local`) || Host(`docs`)"
      # - "traefik.http.routers.devdocs.tls.certresolver=selfsigned"
      # - "traefik.http.routers.devdocs.middlewares=redirect-to-https"
      - "traefik.http.services.devdocs.loadbalancer.server.port=9292"
    restart: unless-stopped

  searxng:
    image: docker.io/searxng/searxng
    environment:
      - BASE_URL=http://search.localhost
      - INSTANCE_NAME=SearXNG
    labels:
      - "traefik.enable=true"
      - >
        traefik.http.routers.searxng.rule=
        Host(`search.localhost`)
        || Host(`search.local`)
        || Host(`search`)
        || Host(`searx.local`)
        || Host(`searx`)
        || Host(`searx.localhost`)
        || Host(`searxng.localhost`)
        || Host(`searxng.local`)
        || Host(`searxng`)
      - "traefik.http.routers.searxng.entrypoints=web"
      # - "traefik.http.routers.searxng.tls.certresolver=selfsigned"
      # - "traefik.http.routers.searxng.middlewares=redirect-to-https"
      - "traefik.http.services.searxng.loadbalancer.server.port=8080"
    restart: unless-stopped

  # kasm-ubuntu:
  #   image: kasmweb/ubuntu-noble-desktop:1.18.0-rolling-weekly
  #   environment:
  #     - VNC_PW=password
  #     - KASM_REQUIRE_SSL=false
  #   shm_size: "1gb"
  #   labels:
  #     - "traefik.enable=true"
  #     - >
  #       traefik.http.routers.kasm.rule=
  #       Host(`kasm.localhost`)
  #       || Host(`kasm.local`)
  #       || Host(`kasm`)
  #       || Host(`desktop.localhost`)
  #       || Host(`desktop.local`)
  #       || Host(`desktop`)
  #       || Host(`ubuntu.localhost`)
  #       || Host(`ubuntu.local`)
  #       || Host(`ubuntu`)
  #     - "traefik.http.routers.kasm.entrypoints=web"
  #     # - "traefik.http.routers.kasm.tls.certresolver=selfsigned"
  #     # - "traefik.http.routers.kasm.middlewares=redirect-to-https"
  #     - "traefik.http.routers.kasm.tls=false"
  #     - "traefik.http.services.kasm.loadbalancer.server.port=6901"
  #   restart: unless-stopped
  #   ports:
  #     # - "6901:6901"
  #     - "5901:5901"

  jupyter:
    image: jupyter/datascience-notebook
    environment:
      - JUPYTER_ENABLE_LAB=yes
      - JUPYTER_TOKEN=dev
      - JUPYTER_PASSWORD=dev
    labels:
      - "traefik.enable=true"
      - >
        traefik.http.routers.jupyter.rule=
        Host(`jupyter.localhost`)
        || Host(`jupyter.local`)
        || Host(`jupyter`)
        || Host(`notebook.localhost`)
        || Host(`notebook.local`)
        || Host(`notebook`)
        || Host(`lab.localhost`)
        || Host(`lab.local`)
        || Host(`lab`)
      - "traefik.http.routers.jupyter.entrypoints=web"
      # - "traefik.http.routers.jupyter.tls.certresolver=selfsigned"
      # - "traefik.http.routers.jupyter.middlewares=redirect-to-https"
      - "traefik.http.middlewares.jupyter-headers.headers.customrequestheaders.X-Forwarded-Proto=http"
      - "traefik.http.routers.jupyter.middlewares=jupyter-headers"
      - "traefik.http.services.jupyter.loadbalancer.server.port=8888"
    restart: unless-stopped

  freshrss:
    image: freshrss/freshrss
    environment:
      - CRON_MINUTES=5
      - UID=1000
      - GID=1000
      - TZ=UTC
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.freshrss.entrypoints=web"
      - "traefik.http.routers.freshrss.rule=Host(`freshrss.localhost`) || Host(`freshrss`) || Host(`freshrss.local`)"
      # - "traefik.http.routers.freshrss.tls.certresolver=selfsigned"
      # - "traefik.http.routers.freshrss.middlewares=redirect-to-https"
      - "traefik.http.services.freshrss.loadbalancer.server.port=80"
    restart: unless-stopped
    # volumes:
    #   - ./freshrss-data:/var/www/FreshRSS/data

  # postgres:
  #   image: postgres
  #   environment:
  #     POSTGRES_USER: postgres
  #     POSTGRES_PASSWORD: postgres
  #     POSTGRES_DB: appdb
  #   # volumes:
  #   #  - pgdata:/var/lib/postgresql/data
  #   restart: unless-stopped

# volumes:
#  pgdata:
#  letsencrypt:

